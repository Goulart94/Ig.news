"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/webhooks";
exports.ids = ["pages/api/webhooks"];
exports.modules = {

/***/ "faunadb":
/*!**************************!*\
  !*** external "faunadb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("faunadb");

/***/ }),

/***/ "stripe":
/*!*************************!*\
  !*** external "stripe" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stripe");

/***/ }),

/***/ "./src/pages/api/_lib/manageSubscription.ts":
/*!**************************************************!*\
  !*** ./src/pages/api/_lib/manageSubscription.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"saveSubscription\": () => (/* binding */ saveSubscription)\n/* harmony export */ });\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../../services/stripe */ \"./src/services/stripe.ts?da1c\");\n/* harmony import */ var _services_fauna__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../services/fauna */ \"./src/services/fauna.ts\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function saveSubscription(subscriptionId, customerId, createdAction = false) {\n    const userRef = await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Index(\"user_by_stripe_custumer_id\"), customerId))));\n    const subscription = await _services_stripe__WEBPACK_IMPORTED_MODULE_0__.stripe.subscriptions.retrieve(subscriptionId);\n    const subscriptionData = {\n        id: subscription.id,\n        userId: userRef,\n        status: subscription.status,\n        price_id: subscription.items.data[0].price.id\n    };\n    if (createdAction) {\n        await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Create(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Collection(\"subscriptions\"), {\n            data: subscriptionData\n        }));\n    } else {\n        await _services_fauna__WEBPACK_IMPORTED_MODULE_1__.fauna.query(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Replace(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Select(\"ref\", faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Get(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Match(faunadb__WEBPACK_IMPORTED_MODULE_2__.query.Index('subscription_by_id'), subscriptionId))), {\n            data: subscriptionData\n        }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGFnZXMvYXBpL19saWIvbWFuYWdlU3Vic2NyaXB0aW9uLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQW1EO0FBQ0o7QUFDWDtBQUU3QixlQUFlSSxnQkFBZ0IsQ0FBQ0MsY0FBc0IsRUFBRUMsVUFBaUIsRUFBRUMsYUFBYSxHQUFHLEtBQUssRUFBSSxDQUFDO0lBRXhHLEtBQUssQ0FBQ0MsT0FBTyxHQUFHLEtBQUssQ0FBQ1Asd0RBQVcsQ0FDN0JFLGlEQUFRLENBQ0osQ0FBSyxNQUNMQSw4Q0FBSyxDQUNEQSxnREFBTyxDQUNIQSxnREFBTyxDQUFDLENBQTRCLDhCQUNwQ0csVUFBVTtJQU8xQixLQUFLLENBQUNPLFlBQVksR0FBRyxLQUFLLENBQUNiLDJFQUE2QixDQUFDSyxjQUFjO0lBRXZFLEtBQUssQ0FBQ1csZ0JBQWdCLEdBQUMsQ0FBQztRQUNyQkMsRUFBRSxFQUFFSixZQUFZLENBQUNJLEVBQUU7UUFDbkJDLE1BQU0sRUFBRVYsT0FBTztRQUNmVyxNQUFNLEVBQUVOLFlBQVksQ0FBQ00sTUFBTTtRQUMzQkMsUUFBUSxFQUFFUCxZQUFZLENBQUNRLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLENBQUMsRUFBRUMsS0FBSyxDQUFDTixFQUFFO0lBRWhELENBQUM7SUFFRCxFQUFFLEVBQUNWLGFBQWEsRUFBQyxDQUFDO1FBQ2IsS0FBSyxDQUFDTix3REFBVyxDQUNoQkUsaURBQVEsQ0FDTkEscURBQVksQ0FBQyxDQUFlLGlCQUM1QixDQUFDbUI7WUFBQUEsSUFBSSxFQUFFTixnQkFBZ0I7UUFBQSxDQUFDO0lBR2hDLENBQUMsTUFBSSxDQUFDO1FBQ0YsS0FBSyxDQUFDZix3REFBVyxDQUNiRSxrREFBUyxDQUNMQSxpREFBUSxDQUNKLENBQUssTUFDTEEsOENBQUssQ0FDREEsZ0RBQU8sQ0FDSEEsZ0RBQU8sQ0FBQyxDQUFvQixzQkFDNUJFLGNBQWMsS0FLMUIsQ0FBQ2lCO1lBQUFBLElBQUksRUFBR04sZ0JBQWdCO1FBQUEsQ0FBQztJQUdyQyxDQUFDO0FBR0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2lnbmV3cy8uL3NyYy9wYWdlcy9hcGkvX2xpYi9tYW5hZ2VTdWJzY3JpcHRpb24udHM/OTFhZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdHJpcGUgfSBmcm9tICcuLy4uLy4uLy4uL3NlcnZpY2VzL3N0cmlwZSc7XHJcbmltcG9ydCB7IGZhdW5hIH0gZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2VzL2ZhdW5hXCI7XHJcbmltcG9ydCB7IHF1ZXJ5IGFzIHEgfSBmcm9tIFwiZmF1bmFkYlwiO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVTdWJzY3JpcHRpb24oc3Vic2NyaXB0aW9uSWQ6IHN0cmluZywgY3VzdG9tZXJJZDpzdHJpbmcsIGNyZWF0ZWRBY3Rpb24gPSBmYWxzZSwgKSB7XHJcblxyXG4gICAgY29uc3QgdXNlclJlZiA9IGF3YWl0IGZhdW5hLnF1ZXJ5KFxyXG4gICAgICAgIHEuU2VsZWN0KFxyXG4gICAgICAgICAgICBcInJlZlwiLFxyXG4gICAgICAgICAgICBxLkdldChcclxuICAgICAgICAgICAgICAgIHEuTWF0Y2goXHJcbiAgICAgICAgICAgICAgICAgICAgcS5JbmRleChcInVzZXJfYnlfc3RyaXBlX2N1c3R1bWVyX2lkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbWVySWRcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgIClcclxuXHJcbiAgICApXHJcbiAgICBcclxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHN0cmlwZS5zdWJzY3JpcHRpb25zLnJldHJpZXZlKHN1YnNjcmlwdGlvbklkKVxyXG5cclxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbkRhdGE9e1xyXG4gICAgICAgaWQ6IHN1YnNjcmlwdGlvbi5pZCxcclxuICAgICAgIHVzZXJJZDogdXNlclJlZixcclxuICAgICAgIHN0YXR1czogc3Vic2NyaXB0aW9uLnN0YXR1cyxcclxuICAgICAgIHByaWNlX2lkOiBzdWJzY3JpcHRpb24uaXRlbXMuZGF0YVswXS5wcmljZS5pZCxcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWYoY3JlYXRlZEFjdGlvbil7XHJcbiAgICAgICAgIGF3YWl0IGZhdW5hLnF1ZXJ5KFxyXG4gICAgICAgICAgcS5DcmVhdGUoXHJcbiAgICAgICAgICAgIHEuQ29sbGVjdGlvbihcInN1YnNjcmlwdGlvbnNcIiksXHJcbiAgICAgICAgICAgIHtkYXRhOiBzdWJzY3JpcHRpb25EYXRhfVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgIClcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGF3YWl0IGZhdW5hLnF1ZXJ5KFxyXG4gICAgICAgICAgICBxLlJlcGxhY2UoXHJcbiAgICAgICAgICAgICAgICBxLlNlbGVjdChcclxuICAgICAgICAgICAgICAgICAgICBcInJlZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHEuR2V0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxLk1hdGNoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcS5JbmRleCgnc3Vic2NyaXB0aW9uX2J5X2lkJyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgIHtkYXRhIDogc3Vic2NyaXB0aW9uRGF0YX0gICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICkgIFxyXG4gICAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBcclxufSJdLCJuYW1lcyI6WyJzdHJpcGUiLCJmYXVuYSIsInF1ZXJ5IiwicSIsInNhdmVTdWJzY3JpcHRpb24iLCJzdWJzY3JpcHRpb25JZCIsImN1c3RvbWVySWQiLCJjcmVhdGVkQWN0aW9uIiwidXNlclJlZiIsIlNlbGVjdCIsIkdldCIsIk1hdGNoIiwiSW5kZXgiLCJzdWJzY3JpcHRpb24iLCJzdWJzY3JpcHRpb25zIiwicmV0cmlldmUiLCJzdWJzY3JpcHRpb25EYXRhIiwiaWQiLCJ1c2VySWQiLCJzdGF0dXMiLCJwcmljZV9pZCIsIml0ZW1zIiwiZGF0YSIsInByaWNlIiwiQ3JlYXRlIiwiQ29sbGVjdGlvbiIsIlJlcGxhY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/pages/api/_lib/manageSubscription.ts\n");

/***/ }),

/***/ "./src/pages/api/webhooks.ts":
/*!***********************************!*\
  !*** ./src/pages/api/webhooks.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _services_stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../services/stripe */ \"./src/services/stripe.ts?da1c\");\n/* harmony import */ var _lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_lib/manageSubscription */ \"./src/pages/api/_lib/manageSubscription.ts\");\n\n\nasync function buffer(readable) {\n    const chunks = [];\n    for await (const chunk of readable){\n        chunks.push(typeof chunk === 'string' ? Buffer.from(chunk) : chunk);\n    }\n    return Buffer.concat(chunks);\n}\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nconst relevantEvent = new Set([\n    'checkout.session.completed',\n    'customer.subscription.updated',\n    'customer.subscription.deleted', \n]);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (req, res)=>{\n    if (req.method === 'POST') {\n        const buf = await buffer(req);\n        const secret = req.headers['stripe-signature'];\n        let event;\n        try {\n            event = _services_stripe__WEBPACK_IMPORTED_MODULE_0__.stripe.webhooks.constructEvent(buf, secret, process.env.STRIPE_SECRET_WEBHOOKS);\n        } catch (err) {\n            return res.status(400).send(`webhooks error: ${err.message}`);\n        }\n        const type = event.type;\n        if (relevantEvent.has(type)) {\n            try {\n                switch(type){\n                    case 'customer.subscription.updated':\n                    case 'customer.subscription.deleted':\n                        const subscription = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(subscription.id, subscription.customer.toString(), false);\n                        break;\n                    case 'checkout.session.completed':\n                        const checkoutSession = event.data.object;\n                        await (0,_lib_manageSubscription__WEBPACK_IMPORTED_MODULE_1__.saveSubscription)(checkoutSession.subscription.toString(), checkoutSession.customer.toString(), true);\n                        break;\n                    default:\n                        throw new Error('unHandle event.');\n                }\n            } catch (err) {\n                return res.status(400).json({\n                    err: 'webhooks fail'\n                });\n            }\n        }\n        res.json({\n            received: true\n        });\n    } else {\n        res.setHeader('Allow', 'POST');\n        res.status(405).end('Method not allowed');\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUNDO1lBQUFBLFFBQVEsRUFBRSxJQUFJO1FBQUEsQ0FBQztJQUUxQixDQUFDLE1BQUssQ0FBQztRQUNOMUIsR0FBRyxDQUFDMkIsU0FBUyxDQUFDLENBQU8sUUFBRSxDQUFNO1FBQzdCM0IsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxFQUFFZ0IsR0FBRyxDQUFDLENBQW9CO0lBQ3pDLENBQUM7QUFDSixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaWduZXdzLy4vc3JjL3BhZ2VzL2FwaS93ZWJob29rcy50cz9kM2E0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHR5cGUgfSBmcm9tICdvcyc7XHJcbmltcG9ydCB7IFN0cmlwZSB9IGZyb20gJ3N0cmlwZSc7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gJy4vYXBpJztcclxuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XHJcbmltcG9ydCB7UmVhZGFibGV9IGZyb20gXCJzdHJlYW1cIjtcclxuaW1wb3J0IHsgc3RyaXBlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvc3RyaXBlJztcclxuaW1wb3J0IHsgRmFCbGFja2JlcnJ5IH0gZnJvbSAncmVhY3QtaWNvbnMvZmEnO1xyXG5pbXBvcnQgeyBzYXZlU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9fbGliL21hbmFnZVN1YnNjcmlwdGlvbic7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBidWZmZXIocmVhZGFibGU6UmVhZGFibGUpIHtcclxuICAgIGNvbnN0IGNodW5rcyA9IFtdO1xyXG5cclxuICAgIGZvciBhd2FpdChjb25zdCBjaHVuayBvZiByZWFkYWJsZSl7XHJcbiAgICAgICAgY2h1bmtzLnB1c2goXHJcbiAgICAgICAgICAgIHR5cGVvZiBjaHVuayA9PT0gJ3N0cmluZycgPyBCdWZmZXIuZnJvbShjaHVuaykgOiBjaHVua1xyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQnVmZmVyLmNvbmNhdChjaHVua3MpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gICBhcGk6e1xyXG4gICAgICAgYm9keVBhcnNlciA6IGZhbHNlXHJcblxyXG4gICB9LFxyXG5cclxufVxyXG5jb25zdCByZWxldmFudEV2ZW50ID0gbmV3IFNldChbXHJcbiAgICBcclxuICAgICAgICAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnLFxyXG4gICAgICAgICdjdXN0b21lci5zdWJzY3JpcHRpb24udXBkYXRlZCcsXHJcbiAgICAgICAgJ2N1c3RvbWVyLnN1YnNjcmlwdGlvbi5kZWxldGVkJyxcclxuXHJcblxyXG5dKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSk9PntcclxuICAgIFxyXG4gICBpZihyZXEubWV0aG9kPT09J1BPU1QnKXtcclxuICAgICBjb25zdCBidWYgPSBhd2FpdCBidWZmZXIocmVxKVxyXG4gICAgIGNvbnN0IHNlY3JldCA9IHJlcS5oZWFkZXJzWydzdHJpcGUtc2lnbmF0dXJlJ11cclxuXHJcbiAgICAgbGV0IGV2ZW50IDogU3RyaXBlLkV2ZW50O1xyXG5cclxuICAgICB0cnl7XHJcbiAgICAgICAgIGV2ZW50ID0gc3RyaXBlLndlYmhvb2tzLmNvbnN0cnVjdEV2ZW50KGJ1Ziwgc2VjcmV0LCBwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX1dFQkhPT0tTKVxyXG4gICAgIH0gY2F0Y2goZXJyKXtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoYHdlYmhvb2tzIGVycm9yOiAke2Vyci5tZXNzYWdlfWAgKTtcclxuICAgICB9XHJcbiAgICBcclxuICAgICBjb25zdCB0eXBlID0gZXZlbnQudHlwZVxyXG5cclxuICAgICBpZihyZWxldmFudEV2ZW50Lmhhcyh0eXBlKSl7XHJcbiAgICAgICAgIFxyXG4gICAgICAgIHRyeXtcclxuICAgICAgICAgICAgc3dpdGNoKHR5cGUpe1xyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjYXNlICdjdXN0b21lci5zdWJzY3JpcHRpb24udXBkYXRlZCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZCc6XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLlN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzYXZlU3Vic2NyaXB0aW9uKFxyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5pZCxcclxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24uY3VzdG9tZXIudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICBmYWxzZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2hlY2tvdXQuc2Vzc2lvbi5jb21wbGV0ZWQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoZWNrb3V0U2Vzc2lvbiA9IGV2ZW50LmRhdGEub2JqZWN0IGFzIFN0cmlwZS5DaGVja291dC5TZXNzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2F2ZVN1YnNjcmlwdGlvbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tvdXRTZXNzaW9uLnN1YnNjcmlwdGlvbi50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja291dFNlc3Npb24uY3VzdG9tZXIudG9TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIClcclxuXHJcbiAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3VuSGFuZGxlIGV2ZW50LicpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe2VyciA6ICd3ZWJob29rcyBmYWlsJ30pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICB9XHJcblxyXG4gICAgcmVzLmpzb24oe3JlY2VpdmVkOiB0cnVlfSlcclxuXHJcbiAgIH0gZWxzZXtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgJ1BPU1QnKVxyXG4gICAgcmVzLnN0YXR1cyg0MDUpLmVuZCgnTWV0aG9kIG5vdCBhbGxvd2VkJylcclxuICAgfTtcclxufVxyXG4iXSwibmFtZXMiOlsic3RyaXBlIiwic2F2ZVN1YnNjcmlwdGlvbiIsImJ1ZmZlciIsInJlYWRhYmxlIiwiY2h1bmtzIiwiY2h1bmsiLCJwdXNoIiwiQnVmZmVyIiwiZnJvbSIsImNvbmNhdCIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJyZWxldmFudEV2ZW50IiwiU2V0IiwicmVxIiwicmVzIiwibWV0aG9kIiwiYnVmIiwic2VjcmV0IiwiaGVhZGVycyIsImV2ZW50Iiwid2ViaG9va3MiLCJjb25zdHJ1Y3RFdmVudCIsInByb2Nlc3MiLCJlbnYiLCJTVFJJUEVfU0VDUkVUX1dFQkhPT0tTIiwiZXJyIiwic3RhdHVzIiwic2VuZCIsIm1lc3NhZ2UiLCJ0eXBlIiwiaGFzIiwic3Vic2NyaXB0aW9uIiwiZGF0YSIsIm9iamVjdCIsImlkIiwiY3VzdG9tZXIiLCJ0b1N0cmluZyIsImNoZWNrb3V0U2Vzc2lvbiIsIkVycm9yIiwianNvbiIsInJlY2VpdmVkIiwic2V0SGVhZGVyIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/pages/api/webhooks.ts\n");

/***/ }),

/***/ "./src/services/fauna.ts":
/*!*******************************!*\
  !*** ./src/services/fauna.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"fauna\": () => (/* binding */ fauna)\n/* harmony export */ });\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! faunadb */ \"faunadb\");\n/* harmony import */ var faunadb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(faunadb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst fauna = new faunadb__WEBPACK_IMPORTED_MODULE_0__.Client({\n    secret: process.env.FAUNA_KEY\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvZmF1bmEudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThCO0FBRXZCLEtBQUssQ0FBQ0MsS0FBSyxHQUFHLEdBQUcsQ0FBQ0QsMkNBQU0sQ0FBQyxDQUFDO0lBRS9CRSxNQUFNLEVBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTO0FBRWhDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvc2VydmljZXMvZmF1bmEudHM/MzIzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NsaWVudH0gZnJvbSAnZmF1bmFkYic7XHJcblxyXG5leHBvcnQgY29uc3QgZmF1bmEgPSBuZXcgQ2xpZW50KHtcclxuXHJcbiAgc2VjcmV0IDogcHJvY2Vzcy5lbnYuRkFVTkFfS0VZICBcclxuXHJcbn0pO1xyXG4iXSwibmFtZXMiOlsiQ2xpZW50IiwiZmF1bmEiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiRkFVTkFfS0VZIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/fauna.ts\n");

/***/ }),

/***/ "./src/services/stripe.ts?da1c":
/*!********************************!*\
  !*** ./src/services/stripe.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"stripe\": () => (/* binding */ stripe)\n/* harmony export */ });\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! stripe */ \"stripe\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(stripe__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _package_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../package.json */ \"./package.json?2eee\");\n\n\nconst stripe = new (stripe__WEBPACK_IMPORTED_MODULE_0___default())(process.env.STRIPE_API_KEY, {\n    apiVersion: '2020-08-27',\n    appInfo: {\n        name: _package_json__WEBPACK_IMPORTED_MODULE_1__.name,\n        version: '0.1.0'\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2VydmljZXMvc3RyaXBlLnRzP2RhMWMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQjtBQUNZO0FBR2hDLEtBQUssQ0FBQ0UsTUFBTSxHQUFHLEdBQUcsQ0FBQ0YsK0NBQU0sQ0FDNUJHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxjQUFjLEVBQzFCLENBQUM7SUFDR0MsVUFBVSxFQUFFLENBQVk7SUFDeEJDLE9BQU8sRUFBQyxDQUFDO1FBQ0xOLElBQUksRUFBRUEsK0NBQUk7UUFDVk8sT0FBTyxFQUFFLENBQU87SUFDcEIsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pZ25ld3MvLi9zcmMvc2VydmljZXMvc3RyaXBlLnRzP2FiOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN0cmlwZSBmcm9tIFwic3RyaXBlXCI7XHJcbmltcG9ydCB7bmFtZX0gZnJvbSAnLi4vLi4vcGFja2FnZS5qc29uJ1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBzdHJpcGUgPSBuZXcgU3RyaXBlKFxyXG4gICAgcHJvY2Vzcy5lbnYuU1RSSVBFX0FQSV9LRVksXHJcbiAgICB7XHJcbiAgICAgICAgYXBpVmVyc2lvbjogJzIwMjAtMDgtMjcnLFxyXG4gICAgICAgIGFwcEluZm86e1xyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiAnMC4xLjAnXHJcbiAgICAgICAgfSxcclxuICAgIH1cclxuKSJdLCJuYW1lcyI6WyJTdHJpcGUiLCJuYW1lIiwic3RyaXBlIiwicHJvY2VzcyIsImVudiIsIlNUUklQRV9BUElfS0VZIiwiYXBpVmVyc2lvbiIsImFwcEluZm8iLCJ2ZXJzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/services/stripe.ts?da1c\n");

/***/ }),

/***/ "./package.json?2eee":
/*!**********************!*\
  !*** ./package.json ***!
  \**********************/
/***/ ((module) => {

module.exports = JSON.parse('{"name":"ignews","private":true,"scripts":{"dev":"next dev","build":"next build","start":"next start","lint":"next lint"},"dependencies":{"@stripe/stripe-js":"^1.22.0","@types/next-auth":"^3.15.0","axios":"^0.25.0","faunadb":"^4.4.2","next":"12.0.8","next-auth":"^4.1.2","react":"17.0.2","react-dom":"17.0.2","react-icons":"^4.3.1","sass":"^1.48.0","stripe":"^8.201.0"},"devDependencies":{"@types/node":"^17.0.8","@types/react":"^17.0.38","eslint":"8.6.0","eslint-config-next":"12.0.8","typescript":"^4.5.4"}}');

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./src/pages/api/webhooks.ts"));
module.exports = __webpack_exports__;

})();